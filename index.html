<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      cpp-python-beginners &middot; Programming for everyone!
    
  </title>

  
  <link rel="canonical" href="https://tatsy.github.io/cpp-python-beginners/">
  

  <link rel="stylesheet" href="https://tatsy.github.io/cpp-python-beginners/public/css/poole.css">
  <link rel="stylesheet" href="https://tatsy.github.io/cpp-python-beginners/public/css/syntax.css">
  <link rel="stylesheet" href="https://tatsy.github.io/cpp-python-beginners/public/css/lanyon.css">
  <link rel="stylesheet" href="https://tatsy.github.io/cpp-python-beginners/public/css/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://tatsy.github.io/cpp-python-beginners/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="https://tatsy.github.io/cpp-python-beginners/public/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://tatsy.github.io/cpp-python-beginners/atom.xml">

  <script type="text/javascript" src="/cpp-python-beginners/public/js/jquery.min.js"></script>
  <script type="text/javascript" src="/cpp-python-beginners/public/js/lightbox.min.js"></script><script>
MathJax = {
    tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true,
        tags: "ams",
        autoload: {
            color: [],
            colorV2: ['color']
        },
        packages: {'[+]': ['noerrors']}
    },
    chtml: {
        scale: 1.1,
        matchFontHeight: false,
        displayAlign: "left",
        displayIndent: "2em"
    },
    options: {
        renderActions: {
            /* add a new named action to render <script type="math/tex"> */
            find_script_mathtex: [10, function (doc) {
            for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            }
            }, '']
        }
    },
    loader: {
        load: ['[tex]/noerrors']
    }
};
</script>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" id="MathJax-script"></script>
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
    styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>初心者向けC++/Pythonプログラミング</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item active" href="https://tatsy.github.io/cpp-python-beginners/">Home</a>

    

    
    
      
        
      
    
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="https://tatsy.github.io/cpp-python-beginners/get_started/">環境設定</a>
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="https://tatsy.github.io/cpp-python-beginners/python/">Pythonプログラミング</a>
        
      
    

    <a class="sidebar-nav-item" href="https://github.com/tatsy/cpp-python-beginners">GitHub project</a>
    <span class="sidebar-nav-item">Currently v1.0.0</span>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2020. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/cpp-python-beginners/" title="Home">cpp-python-beginners</a>
            <small>Programming for everyone!</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://tatsy.github.io/cpp-python-beginners/2020/04/24/solve-sudoku/">
        数独を解く
      </a>
    </h1>

    <span class="post-date">24 Apr 2020</span>

    

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://tatsy.github.io/cpp-python-beginners/2020/04/24/read-binary/">
        バイナリファイルの読み込み
      </a>
    </h1>

    <span class="post-date">24 Apr 2020</span>

    <h2 id="mnistのダウンロード">MNISTのダウンロード</h2>

<p>MNIST (Mixed National Institute of Standards and Technology) とは同名の機関が作った手書き文字のデータベース。 32x32の白黒画像が学習用に60000枚、テスト用に10000枚含まれている。以下のウェブページからデータをダウンロード。</p>

<p><a href="http://yann.lecun.com/exdb/mnist/" target="_blank">http://yann.lecun.com/exdb/mnist/</a></p>

<ul>
  <li>train-images-idx3-ubyte.gz:  training set images (9912422 bytes)</li>
  <li>train-labels-idx1-ubyte.gz:  training set labels (28881 bytes)</li>
  <li>t10k-images-idx3-ubyte.gz:   test set images (1648877 bytes)</li>
  <li>t10k-labels-idx1-ubyte.gz:   test set labels (4542 bytes)</li>
</ul>

<p><em>注意: これらのファイルは <code class="highlighter-rouge">*.gz</code> 形式で圧縮されているので展開してから使う</em></p>

<p>これらのファイルのうち <code class="highlighter-rouge">images-idx3</code> とあるものは画像の情報を <code class="highlighter-rouge">labels-idx1</code> とあるものは、各画像が数字のいくつを表しているのかを保存している。各ファイル内のデータのバイトオーダ (何バイト目に何が書いてあるか) はページ下部の「FILE FORMATS FOR THE MNIST DATABASE」に説明がある。</p>

<h2 id="バイナリデータを読む">バイナリデータを読む</h2>

<p>Pythonではバイナリデータの読み込みは <code class="highlighter-rouge">struct</code> というパッケージを使う。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">struct</span>

<span class="c1"># ファイルを開く (rbはread binaryの意味)
</span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'binary_file.bin'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span>

<span class="c1"># 4バイト読む
</span><span class="n">b</span> <span class="o">=</span> <span class="n">fp</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># バイトを整数に変換
# MNISTの先頭4バイトはファイル識別用のマジックナンバー
</span><span class="n">magic</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">'&gt;i'</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">magic</span><span class="p">)</span>

<span class="c1"># ファイルを閉じる
</span><span class="n">fp</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>上記のコードで <code class="highlighter-rouge">struct.unpack('&gt;i', b)</code> とあるが、この中の <code class="highlighter-rouge">&gt;i</code> の部分はリトルエンディアン (<code class="highlighter-rouge">&gt;</code>) で、4バイト符号付き整数を読むということ。他のフォーマットについては<a href="https://docs.python.org/ja/3/library/struct.html" target="_blank">ドキュメント</a>を見よう。</p>

<h2 id="mnist内の画像を表示する">MNIST内の画像を表示する</h2>

<p>「FILE FORMATS FOR THE MNIST DATABASE」によれば画像ファイルは最初の4バイトがマジックナンバー (2051) で、その後、4バイト区切りで画像数 (6000)、画像の高さ (28)、画像の幅 (28)が入っている。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># マジックナンバー
</span><span class="n">magic</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">'&gt;i'</span><span class="p">,</span> <span class="n">fp</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="c1"># 画像数、高さ、幅 (一気に複数の数字をunpackすることもできる)
</span><span class="n">n_images</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">'&gt;iii'</span><span class="p">,</span> <span class="n">fp</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>

<p>それ以後は1枚1枚の画像の情報が書かれている。1枚の画像の各画素は白黒の値が0-255 (1バイト符号なし整数)で書かれていて、それが28x28=784画素分ある。故に画像1枚分のデータは784バイトになる。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pixels</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">'&gt;B'</span><span class="p">,</span> <span class="n">fp</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">))</span>
</code></pre></div></div>

<p>このままでは画像として表示できないので、これを <strong>NumPy</strong> の配列に変更して、形を変更しよう。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pixels</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pixels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'uint8'</span><span class="p">)</span>
<span class="n">pixels</span> <span class="o">=</span> <span class="n">pixels</span><span class="p">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>
</code></pre></div></div>

<p>試しに表示してみる。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pixels</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p>すると以下のような画像が出る。</p>

<p><a class="lightbox-link" href="/cpp-python-beginners/public/images/read_binary/mnist_1.jpg" data-lightbox="images-1" data-title=""><img src="/cpp-python-beginners/public/images/read_binary/mnist_1.jpg" alt="" style="" /></a></p>

<p>色が変だが、これはMatplotLibのカラーマップが自動的に適用されたため。グレースケールの画像にしたければ、カラーマップを自分で指定する。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pixels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'gray'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><a class="lightbox-link" href="/cpp-python-beginners/public/images/read_binary/mnist_2.jpg" data-lightbox="images-1" data-title=""><img src="/cpp-python-beginners/public/images/read_binary/mnist_2.jpg" alt="" style="" /></a></p>

<h2 id="画像をタイル状に表示する">画像をタイル状に表示する</h2>

<p>これは一工夫必要。まず100枚画像を読み込もう。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">pixels</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">'&gt;'</span> <span class="o">+</span> <span class="s">'B'</span> <span class="o">*</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">,</span> <span class="n">fp</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">))</span>
    <span class="n">pixels</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pixels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'uint8'</span><span class="p">)</span>
    <span class="n">pixels</span> <span class="o">=</span> <span class="n">pixels</span><span class="p">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>
    <span class="n">images</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pixels</span><span class="p">)</span>
</code></pre></div></div>

<p>これを10x10のタイル状に表示したい。MatplotLibは描画のウィンドウを表す <code class="highlighter-rouge">figure</code> と、実際に画像やグラフが表示される <code class="highlighter-rouge">axis</code> があり、<code class="highlighter-rouge">figure</code>に<code class="highlighter-rouge">axis</code>を追加していく形で複数の画像を表示できる。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">j</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="c1"># 10x10のタイルのindex番目のaxisという意味
</span>        <span class="c1"># 番号は1から始まるので1を足しておく
</span>        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># グレースケールで表示
</span>        <span class="n">ax</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'gray'</span><span class="p">)</span>
        <span class="c1"># 画像の周りにある目盛りを消す
</span>        <span class="n">ax</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'off'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><a class="lightbox-link" href="/cpp-python-beginners/public/images/read_binary/mnist_tile.jpg" data-lightbox="images-1" data-title=""><img src="/cpp-python-beginners/public/images/read_binary/mnist_tile.jpg" alt="" style="" /></a></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://tatsy.github.io/cpp-python-beginners/python/2020/04/24/linear-regression/">
        線形回帰
      </a>
    </h1>

    <span class="post-date">24 Apr 2020</span>

    <h2 id="ロジスティック回帰の概要">ロジスティック回帰の概要</h2>

<p><a href="/cpp-python-beginners/2020/04/24/read-binary/">バイナリファイルの読み込み</a>で読み込んだMNISTのデータを使って、単純な線形モデルで数字を予想する。</p>

<p>一般に線形回帰、といったときにはデータベクトル $\mathbf{x}$ を入力として、何らかの推定値 $\mathbf{y}$ を線形式、すなわち</p>

\[\mathbf{y} = \mathbf{Ax} + \mathbf{b}\]

<p>という式で関係付ける。出力の推定値が何らかの確率であれば、これにsigmoid関数やsoftmax関数をつけて、</p>

\[\begin{aligned}
    \mathbf{y} = \text{sigmoid}(\mathbf{Ax} + \mathbf{b}) \\
    \mathbf{y} = \text{softmax}(\mathbf{Ax} + \mathbf{b}) \\
\end{aligned}\]

<p>のようにする。特にsigmoid関数を使うものをロジスティック回帰という(softmaxを使うものも含む場合もある)。なお、sigmoid関数、softmax関数はそれぞれ次のように表される。</p>

\[\begin{aligned}
    \text{sigmoid}(x) = \frac{1}{1 + e^{-x}} \\
    \text{softmax}(\mathbf{x})_i = \frac{e^{x_i}}{\sum_{k=1}^d e^{x_k}}
\end{aligned}\]

<p>機械学習における推定のタスクにおいて、二者分類のときにはsigmoid関数が、多者分類のときにはsoftmax関数が使われるのが一般的である。今回のMNISTは出力の推定値が <strong>画像$\mathbf{x}$が数字の$i$を表す確率$y_i$</strong>を求めるのが目標なのでsoftmax関数を使う。</p>

<h2 id="scikit-learnによるロジスティック回帰">scikit-learnによるロジスティック回帰</h2>

<p>scikit-learnはとても簡単。前回の内容に従って画像を読み込むと、画像とラベルを格納したNumPyの配列はそれぞれ (60000, 28, 28, 1) と (60000, 1) になっているはずである。前者は各画素に0-255の画素値が含まれており、後者は、その画像がどの数字なのかを表す整数が格納されている。</p>

<p>上記の通り、線形モデルではベクトルを扱うので、画像の画素値を1列に並べ直してベクトル化しよう。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n_images</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">images</span><span class="p">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n_images</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></div>

<p>さらに、配列の型を1バイト符号なし整数から32ビット浮動小数に変換しておく。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'float32'</span><span class="p">)</span>
</code></pre></div></div>

<p>あとは<a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html" target="_blank">ドキュメント</a>の内容に従い<code class="highlighter-rouge">LogisticRegression</code>クラスを使って識別器を学習する。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s">'multinomial'</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<p>少し時間がかかるが、しばらくすると学習が終わる。なお上記のコード内での <code class="highlighter-rouge">y</code> は整数型のラベルを格納したNumPyの配列で良い(分かりやすくするために名前を変更した)。</p>

<h2 id="テストデータに対する予測">テストデータに対する予測</h2>

<p>学習が終わったら、次はテストデータを読み込んで、正解率を求める。上記の <code class="highlighter-rouge">clf</code> というオブジェクトに対して、以下のようなコードを呼び出すと、ラベルが自動で計算される。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pred_labels</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div></div>

<p>正解率は、このラベルがテストのラベルとどのくらい近いかを計算すれば良いのだから、正解かどうか(0 or 1)の平均を全てのテストデータに対して計算すれば良い。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">acc</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred_labels</span> <span class="o">==</span> <span class="n">y_test</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></div>

<p>ただしく学習できていれば90%程度の正解率となるはずである。</p>

<h2 id="ロジスティック回帰を再現する">ロジスティック回帰を再現する</h2>

<p>上記の通り、ロジスティック回帰による識別モデルは、線形変換とsoftmax関数の組み合わせである。softmax関数にはパラメータ変数は含まれないので、回帰モデル自体のパラメータは行列 $\mathb{A}$ とバイアスベクトル $\mathbf{b}$ のみである。</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://tatsy.github.io/cpp-python-beginners/2020/04/24/image-load/">
        画像の読み込み・表示・保存
      </a>
    </h1>

    <span class="post-date">24 Apr 2020</span>

    <h2 id="opencvを使った画像のロード">OpenCVを使った画像のロード</h2>

<ul>
  <li>ライブラリのインポート</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</code></pre></div></div>

<ul>
  <li>画像を読み込む</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">imread</span><span class="p">(</span><span class="s">'lena.png'</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>画像の表示</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p>Jupyter Labで新しいIPython Notebook (*.ipnbファイル) を作って、上記のコードを打ち込んでみよう。</p>

<h2 id="画像の色変換">画像の色変換</h2>

<p>OpenCVは色のチャンネルがBGR (青, 緑, 赤) の順になっている。これを入れ替える。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
</code></pre></div></div>

<p>もう一度表示してみる。</p>

<p>画像の色表現には色々なものがある。それぞれは何が違うのだろうか？調べてみよう。</p>

<ul>
  <li>HSV色空間</li>
  <li>YCbCr色空間</li>
  <li>Lab色空間</li>
  <li>XYZ色空間</li>
</ul>

<h2 id="画像のサイズを変える">画像のサイズを変える</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 大きさを指定してサイズを変える
</span><span class="n">resized_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">320</span><span class="p">))</span>
<span class="c1"># 比率を指定してサイズを変える
</span><span class="n">resized_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">fx</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fy</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="画像の保存">画像の保存</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cv2</span><span class="p">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s">'lena_resized.png'</span><span class="p">,</span> <span class="n">resized_image</span><span class="p">)</span>
</code></pre></div></div>

  </div>
  
</div>

<div class="pagination">
  
    <span class="pagination-item older">Older</span>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src='/cpp-python-beginners/public/js/script.js'></script>
  </body>
</html>
